!function(e){e.fn.highlightAndGoTo=function(t){var a=e(this);return e("a",t).removeClass("active"),e("li.module-title",t).removeClass("open"),a.addClass("active"),a.closest("li.module-title").addClass("open"),e(this)[0].closest("li.module-title").scrollIntoView(),this},e.fn.extend({toggleText:function(e,t){return this.text(this.text()==t?e:t)}}),"undefined"==typeof localStorage?document.getElementById("result").innerHTML="Your browser does not support HTML5 localStorage. Try upgrading.":null!=localStorage.getItem("pref")&&(getPref=localStorage.pref,e("body").addClass("dark-mode"),e("a.mode").text("Light Mode")),e(document).ready(function(){e("a.mode").on("click",function(){getPref=localStorage.pref,e("body").toggleClass("dark-mode"),e("a.mode").toggleText("Dark Mode","Light Mode"),e("body").hasClass("dark-mode")?localStorage.setItem("pref","dark-mode"):localStorage.removeItem("pref")})}),"undefined"==typeof localStorage?document.getElementById("result").innerHTML="Your browser does not support HTML5 localStorage. Try upgrading.":null!=localStorage.getItem("menu")&&(getMenu=localStorage.menu,e("a.menu-toggle").addClass("closed"),e(".nav-tray").addClass("closed")),e(document).ready(function(){e("a.menu-toggle").on("click",function(){getMenu=localStorage.menu,e(this).toggleClass("closed"),e(".nav-tray").toggleClass("closed"),e("a.menu-toggle").hasClass("closed")?localStorage.setItem("menu","closed"):localStorage.removeItem("menu")})}),e("#nav").on("click","li.module-title",function(t){e(".module-title").removeClass("open"),e(this).addClass("open")}),window.PWK=new function(){var t={},a={},o=function(t){return function(a,o){var n,l;n=[],l=new RegExp(a,"i"),e.each(t,function(t,a){l.test(t)&&e(a).each(function(e,t){n.push(t)})}),o(n)}},n=function(t,o){e('nav a[data-media-path="'+t.path+'"]').highlightAndGoTo(a.nav);var n=a.video[0];n.src=t.path;var l=document.getElementById("captions"),s=location.hostname;t.caption.length>0&&""!=s?l.src=t.caption:e("#captions").remove(),e(n).on("loadedmetadata",function(){n.currentTime=o>=10?o-10:o,this.play()})};this.loadFromURI=function(){location.hash.length>0&&location.hash.match(/[<>]+/)&&(location.href="index.html");var t=decodeURIComponent(location.hash.split("#")[1]);if(t){var o=/video-path=(.*?)\&/.exec(t)[1],l=/.*time-offset=([0-9]+)$/i.exec(t)[1];e(a.modules).each(function(t,a){a.path===o?n(a,l):e(a.subModules).each(function(t,a){a.path===o?n(a,l):e(a.subSections).each(function(e,t){t.path===o&&n(t,l)})})})}};var l=function(e,t=null,o=null){var n=void 0===a.modules[e];if(!e||!n){var l,s=void 0===a.modules[e].subModules[t];if(!(null!==t&&s||null!==t&&(l=void 0===a.modules[e].subModules[t].subSections,null!==o&&l)))return null!==o?a.modules[e].subModules[t].subSections[o]:null!==t?a.modules[e].subModules[t]:a.modules[e]}},s=function(){var t,o=document.getElementById("video"),n=o.currentSrc.split("/").reverse()[0].replace(".mp4","").split("_"),s=(n=e(o).attr("src").split("/").reverse()[0].replace(".mp4","").split("_"))[0];e(a.modules).each((e,a)=>{/media\/video\/(.*?)\_/.exec(a.path)[1]===s&&(t=e)});var i=n[1],r=parseInt(i)-1,p=parseInt(i),d=n[2],c=parseInt(d);return nextVidCandidate=-1===r?l(t,p):l(t,r,c),nextVidCandidate||(nextVidCandidate=l(t,p)),nextVidCandidate||(nextVidCandidate=l(t+1)),nextVidCandidate};this.init=function(n){var l=this;a={modules:null,video:null,nav:null},e.extend(a,n),e("*",a.nav).remove(),e(a.modules).each(function(o,n){e(n.tags).each(function(e,a){t[a]=t[a]||[],t[a].push({module:n.title,"sub-module":"Main",path:n.path})});var s=e('<li class="module-title" />');s.append(e("<a />",{class:"module active",href:"index.html#video-path="+n.path+"&time-offset=0",html:n.title,"data-media-path":n.path,"data-caption-path":n.caption}).on("click",function(){e(".module-title").removeClass("open"),e(this).addClass("open"),location.href="#video-path="+n.path+"&time-offset=0",l.loadFromURI()}));var i=e('<ul class="submenu" />');e(n.subModules).each(function(a,o){e(o.tags).each(function(e,a){t[a]=t[a]||[],t[a].push({module:n.title,"sub-module":o.title,path:o.path})});var s=e("<li />");s.append(e("<a />",{class:"sub-module active",href:"index.html#video-path="+o.path+"&time-offset=0",html:o.title,"data-media-path":o.path,"data-caption-path":o.caption}).on("click",function(){location.href="#video-path="+o.path+"&time-offset=0",l.loadFromURI()})),i.append(s);var r=e('<ul class="subSection-menu" />');e(o.subSections).length&&e(o.subSections).each(function(a,o){e(o.tags).each(function(e,a){t[a]=t[a]||[],t[a].push({module:n.title,"sub-module":o.title,path:o.path})});var s=e("<li />");s.append(e("<a />",{class:"sub-module active",href:"index.html#video-path="+o.path+"&time-offset=0",html:"&ndash;&nbsp;"+o.title,"data-media-path":o.path,"data-caption-path":o.caption}).on("click",function(){location.href="#video-path="+o.path+"&time-offset=0",l.loadFromURI()})),r.append(s)}),i.append(r)}),s.append(i),a.nav.append(s)}),a.video.on("timeupdate",function(){location.href=location.href.replace(/time-offset=(\d)+/i,"time-offset="+Math.floor(this.currentTime).toString())}),a.video.on("ended",function(){if(!1===e("#loop")[0].checked)return!1;!function(){var t=s();if(!t)return!1;var a=t.path,o=e('nav a[data-media-path="'+a+'"]');o.data("module"),o.data("sub-module"),location.href="#video-path="+a+"&time-offset=0",l.loadFromURI()}()}),e("#search-bar .typeahead").typeahead({hint:!0,highlight:!1,minLength:2},{name:"tags",limit:10,source:o(t),display:"garbage_that_wont_be_displayed",templates:{empty:'<div class="empty-message">No matches</div>',suggestion:Handlebars.compile(['<div onclick="location.href=\'#video-path={{path}}&time-offset=0\';PWK.loadFromURI();" data-path="{{path}}">',"{{module}} - {{sub-module}}","</div>"].join("\r\n"))}}),location.href.match(/#video-path=/)?this.loadFromURI():e("a",a.nav).first().click(),new Plyr("#video",{captions:{update:!0},controls:'\n            <div class="plyr__controls">\n                <button type="button" id="restart" class="plyr__control" data-plyr="restart">\n                    \x3c!--<svg role="presentation"><use xlink:href="#plyr-restart"></use></svg>--\x3e\n                    <img src="media/img/restart.svg" />\n                    <span class="plyr__tooltip" role="tooltip">Restart</span>\n                </button>\n                <button type="button" id="rewind" class="plyr__control" data-plyr="rewind">\n                    \x3c!-- <svg role="presentation"><use xlink:href="#plyr-rewind"></use></svg> --\x3e\n                    <img src="media/img/rewind.svg" />\n                    <span class="plyr__tooltip" role="tooltip">Rewind {seektime} secs</span>\n                </button>\n                <button type="button" class="plyr__control" aria-label="Play, {title}" data-plyr="play">\n                    <svg class="icon--pressed" role="presentation"><use xlink:href="#plyr-pause"></use></svg>\n                    <svg class="icon--not-pressed" role="presentation"><use xlink:href="#plyr-play"></use></svg>\n                    <span class="label--pressed plyr__tooltip" role="tooltip">Pause</span>\n                    <span class="label--not-pressed plyr__tooltip" role="tooltip">Play</span>\n                </button>\n                <button type="button" id="forward" class="plyr__control" data-plyr="fast-forward">\n                    \x3c!--<svg role="presentation"><use xlink:href="#plyr-fast-forward"></use></svg>--\x3e\n                    <img src="media/img/forward.svg" />\n                    <span class="plyr__tooltip" role="tooltip">Forward {seektime} secs</span>\n                </button>\n                <button type="button" id="nextVideo" class="plyr__control">\n                    <img src="media/img/step-forward.svg" />\n                    <span class="plyr__tooltip" role="tooltip">Next Video</span>\n                </button>\n                <div class="plyr__controls__item plyr__progress__container">\n                    <div class="plyr__progress">\n                        <input data-plyr="seek" type="range" min="0" max="100" step="0.01" value="0" aria-label="Seek">\n                        <progress class="plyr__progress__buffer" min="0" max="100" value="0">% buffered</progress>\n                        <span role="tooltip" class="plyr__tooltip">00:00</span>\n                    </div>\n                </div>\n                <div class="plyr__time plyr__time--current" aria-label="Current time">00:00</div>\n                <div class="plyr__time plyr__time--duration" aria-label="Duration">00:00</div>\n                <button type="button" class="plyr__control" aria-label="Mute" data-plyr="mute">\n                    <svg class="icon--pressed" role="presentation"><use xlink:href="#plyr-muted"></use></svg>\n                    <svg class="icon--not-pressed" role="presentation"><use xlink:href="#plyr-volume"></use></svg>\n                    <span class="label--pressed plyr__tooltip" role="tooltip">Unmute</span>\n                    <span class="label--not-pressed plyr__tooltip" role="tooltip">Mute</span>\n                </button>\n                <div class="plyr__volume">\n                    <input data-plyr="volume" type="range" min="0" max="1" step="0.05" value="1" autocomplete="off" aria-label="Volume">\n                </div>\n                <button type="button" class="plyr__control" data-plyr="captions">\n                    <svg class="icon--pressed" role="presentation"><use xlink:href="#plyr-captions-on"></use></svg>\n                    <svg class="icon--not-pressed" role="presentation"><use xlink:href="#plyr-captions-off"></use></svg>\n                    <span class="label--pressed plyr__tooltip" role="tooltip">Disable captions</span>\n                    <span class="label--not-pressed plyr__tooltip" role="tooltip">Enable captions</span>\n                </button>\n                <button type="button" class="plyr__control" data-plyr="fullscreen">\n                    <svg class="icon--pressed" role="presentation"><use xlink:href="#plyr-exit-fullscreen"></use></svg>\n                    <svg class="icon--not-pressed" role="presentation"><use xlink:href="#plyr-enter-fullscreen"></use></svg>\n                    <span class="label--pressed plyr__tooltip" role="tooltip">Exit fullscreen</span>\n                    <span class="label--not-pressed plyr__tooltip" role="tooltip">Enter fullscreen</span>\n                </button>\n            </div>\n            '}),e("#nextVideo").on("click",function(){var t,a,o=s();o&&(t=o.path,(a=e('nav a[data-media-path="'+t+'"]')).data("module"),a.data("sub-module"),location.href="#video-path="+t+"&time-offset=0",l.loadFromURI())})}}}(jQuery);