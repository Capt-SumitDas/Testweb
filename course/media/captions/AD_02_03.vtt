WEBVTT

00:00:01.952 --> 00:00:04.300
Resolving Nested Groups

00:00:04.761 --> 00:00:08.266
Next, let’s use our our newly
developed PowerShell script

00:00:08.266 --> 00:00:12.733
to unravel the nested groups
we found with net.exe.

00:00:26.173 --> 00:00:31.766
The first task is to locate all groups
in the domain and print their names.

00:00:32.530 --> 00:00:35.966
To do this, we will create a
filter extracting all records

00:00:35.966 --> 00:00:39.166
with an objectClass set to “Group”.

00:00:39.859 --> 00:00:42.733
In addition, we will only
print the name property

00:00:42.733 --> 00:00:45.666
for each group instead of all properties.

00:00:50.868 --> 00:00:55.200
When executed, the script outputs
a list of all groups in the domain.

00:00:59.301 --> 00:01:02.600
There are several groups
including Secret_Group,

00:01:02.600 --> 00:01:06.766
Nested_Group and
Another_Nested_Group.

00:01:23.863 --> 00:01:27.933
Now let’s try to list the members
of the group “Secret_Group”

00:01:27.933 --> 00:01:31.033
by setting a filter on the name property.

00:01:32.329 --> 00:01:36.866
We will only display the member
attribute to obtain the group members.

00:01:43.577 --> 00:01:46.100
The modified script will
dump the names of the

00:01:46.100 --> 00:01:48.533
DistinguishedName group members.

00:01:51.249 --> 00:01:56.666
According to this output, Nested_Group
is a member of Secret_Group.

00:01:57.554 --> 00:02:00.666
To enumerate its members,
we must repeat the steps

00:02:00.666 --> 00:02:04.533
performed in order to list the
members of Nested_Group.

00:02:09.468 --> 00:02:13.166
We can do this by replacing
the group name in the filter.

00:02:24.902 --> 00:02:30.733
This indicates that Another_Nested_Group
is the only member of Nested_Group.

00:02:37.604 --> 00:02:40.000
We’ll need to modify the script again,

00:02:40.000 --> 00:02:44.000
replacing Nested_Group
with Another_Nested_Group.

00:02:58.380 --> 00:03:02.266
Finally we find that the domain user Adam

00:03:02.266 --> 00:03:06.066
is the sole member of
Another_Nested_Group.

00:03:07.149 --> 00:03:11.533
This ends the enumeration required
to enumerate the nested groups

00:03:11.533 --> 00:03:14.833
and demonstrates how
PowerShell and LDAP

00:03:14.833 --> 00:03:18.100
can be leveraged to perform
this kind of lookup.
