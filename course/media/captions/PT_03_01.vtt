WEBVTT

00:00:01.405 --> 00:00:03.572
PowerShell File Transfers

00:00:04.976 --> 00:00:06.609
Continuing with Alice and Bob,

00:00:06.609 --> 00:00:12.843
we’ll transfer the Windows version of
wget from Alice to Bob using PowerShell.

00:00:14.257 --> 00:00:16.657
We will transfer the file over HTTP

00:00:16.657 --> 00:00:20.691
so we’ll quickly copy
wget.exe to our webroot

00:00:22.257 --> 00:00:24.324
and start our Apache webserver.

00:00:25.939 --> 00:00:28.739
Because of the power and
flexibility of PowerShell,

00:00:28.757 --> 00:00:32.691
transferring a file is not as straight-
forward as it would be with Netcat

00:00:32.691 --> 00:00:33.957
or even with socat,

00:00:33.957 --> 00:00:38.257
making these first few commands
a bit confusing at first glance.

00:00:49.972 --> 00:00:53.439
We’ll execute the command then
break down the components.

00:00:56.257 --> 00:00:58.324
We can see that the command executed,

00:00:58.324 --> 00:01:02.091
the file was transferred and
it executes without incident.

00:01:02.691 --> 00:01:05.957
Let’s break down the PowerShell
command that made this happen.

00:01:07.187 --> 00:01:10.053
First, we used the -c option.

00:01:10.605 --> 00:01:14.239
This will execute the supplied command
(wrapped in double-quotes)

00:01:14.239 --> 00:01:16.872
as if it were typed at the
PowerShell prompt.

00:01:17.472 --> 00:01:20.872
The command we executed
contains several components.

00:01:21.676 --> 00:01:23.676
The “new-object” cmdlet

00:01:23.676 --> 00:01:28.609
lets us instantiate either a
.Net Framework or a COM object.

00:01:29.305 --> 00:01:33.639
In this case we’re creating an
instance of the WebClient class,

00:01:33.639 --> 00:01:38.839
which is defined and implemented
in the System.Web namespace.

00:01:39.424 --> 00:01:43.924
The WebClient class contains a
public method called DownloadFile.

00:01:44.305 --> 00:01:47.472
This method requires our
two key parameters:

00:01:47.472 --> 00:01:50.839
a source location (in the form of a URI)…

00:01:51.224 --> 00:01:55.057
…and a target location where the
retrieved data will be stored.

00:01:55.739 --> 00:01:59.672
With the wget.exe executable
downloaded on Bob’s computer,

00:01:59.672 --> 00:02:03.305
he can use it as another tool
to download additional files

00:02:03.305 --> 00:02:06.572
or continue using PowerShell
for this purpose.
