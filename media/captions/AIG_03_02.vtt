WEBVTT

00:00:01.373 --> 00:00:04.373
Nmap SMB NSE Scripts

00:00:05.377 --> 00:00:09.866
Nmap contains many useful NSE scripts
that can be used to discover

00:00:09.866 --> 00:00:12.333
and enumerate SMB services.

00:00:12.997 --> 00:00:16.300
These scripts can be found in the
nmap scripts directory.

00:00:17.821 --> 00:00:22.933
Here we find several interesting
Nmap SMB NSE scripts

00:00:22.933 --> 00:00:26.166
that perform various tasks such as

00:00:26.166 --> 00:00:30.033
OS discovery and enumeration via SMB.

00:00:32.933 --> 00:00:36.600
Let’s try the smb-os-discovery module.

00:00:40.735 --> 00:00:43.633
This particular script identified
a potential match

00:00:43.633 --> 00:00:45.433
for the host operating system.

00:00:48.460 --> 00:00:51.566
To check for known
SMB protocol vulnerabilities,

00:00:51.566 --> 00:00:55.733
we can invoke one of the
smb-vuln NSE scripts.

00:00:57.446 --> 00:01:01.500
We will take a look at smb-vuln-ms08-067,

00:01:01.500 --> 00:01:07.100
which uses the –script-args option
to pass arguments to the NSE script.

00:01:10.083 --> 00:01:14.300
Note that by setting the
script argument unsafe=1,

00:01:14.300 --> 00:01:19.766
the script is almost (or totally)
guaranteed to crash a vulnerable system.

00:01:21.000 --> 00:01:22.100
Needless to say,

00:01:22.100 --> 00:01:25.866
we should exercise extreme caution
when enabling this argument,

00:01:25.866 --> 00:01:28.900
especially when scanning
production systems.

00:01:33.670 --> 00:01:37.400
In this case, Nmap identifies that
the specific SMB service

00:01:37.400 --> 00:01:40.400
is missing at least
one critical patch

00:01:40.518 --> 00:01:42.633
for the MS08-067.
