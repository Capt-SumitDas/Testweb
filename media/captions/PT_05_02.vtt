WEBVTT

00:00:01.647 --> 00:00:03.447
Advanced Header Filtering

00:00:04.680 --> 00:00:06.780
In order to uncover the rest
of the mystery,

00:00:06.780 --> 00:00:09.680
we’ll need to rely on advanced
header filtering.

00:00:10.613 --> 00:00:14.813
At this point, to better inspect the
requests and responses in the dump,

00:00:14.813 --> 00:00:19.113
we’d like to filter out and display
only the data packets.

00:00:20.041 --> 00:00:24.574
To do this, we’ll look for packets that
have the ACK and PSH flags turned on,

00:00:24.574 --> 00:00:30.508
which are represented by the fourth and
fifth bit of the 14th byte, respectively.

00:00:35.680 --> 00:00:39.580
Turning on only these bits
would give us decimal 24.

00:00:40.044 --> 00:00:44.477
We can pass this number to tcpdump
as a display filter to indicate that we

00:00:44.477 --> 00:00:48.077
only want to see packets with
the ACK and PSH bits set.

00:00:48.916 --> 00:00:52.883
We will use the -A option to
print the packets in ASCII.

00:00:53.613 --> 00:00:59.413
Bear in mind that the tcpdump array index
used for counting the bytes starts at zero

00:00:59.413 --> 00:01:04.380
which is why we are using 13
here to indicate the 14th byte.

00:01:05.277 --> 00:01:08.711
The combination of these two flags
will hopefully show us only the

00:01:08.711 --> 00:01:11.747
HTTP requests and responses data.

00:01:15.147 --> 00:01:17.747
From here, our story becomes clearer.

00:01:18.444 --> 00:01:20.577
We see a significant amount
of failed attempts

00:01:20.577 --> 00:01:23.644
to authenticate to the /admin directory

00:01:24.077 --> 00:01:27.411
which resulted in HTTP 401 replies,

00:01:28.111 --> 00:01:32.458
while the last attempt to login
seems to have succeeded…

00:01:32.458 --> 00:01:36.625
…as the server replied with
a HTTP 301 response.

00:01:37.874 --> 00:01:42.274
It seems someone gained access
to one of megacorpone’s servers!

00:01:43.274 --> 00:01:48.108
TCPDump and wireshark are both excellent
sniffers despite the differing interfaces,

00:01:48.108 --> 00:01:51.841
making each of them suitable
during a penetration test.
