WEBVTT

00:00:02.128 --> 00:00:04.333
SMTP Enumeration

00:00:04.941 --> 00:00:07.966
We can often gather information
about a host or network

00:00:07.966 --> 00:00:10.000
from vulnerable mail servers.

00:00:11.131 --> 00:00:16.100
The Simple Mail Transport Protocol
supports several interesting commands,

00:00:16.100 --> 00:00:18.600
such as VRFY and EXPN.

00:00:19.781 --> 00:00:24.400
A VRFY request asks the server
to verify an email address,

00:00:24.400 --> 00:00:29.033
while EXPN asks the server for
the membership of a mailing list.

00:00:32.016 --> 00:00:36.000
These can often be abused to verify
existing users on a mail server,

00:00:36.000 --> 00:00:39.100
which is useful information
during a penetration test.

00:00:40.281 --> 00:00:42.900
Let’s check out the VRFY
command in action

00:00:42.900 --> 00:00:46.533
by using netcat to connect
to port 25 on a mail server.

00:00:56.534 --> 00:00:59.733
Notice how the success and
error messages differ.

00:01:00.376 --> 00:01:04.266
The SMTP server happily
verifies that the user exists.

00:01:07.541 --> 00:01:12.633
This procedure can be used to help guess
valid usernames in an automated fashion.

00:01:15.698 --> 00:01:18.900
This Python script opens a TCP socket,

00:01:18.900 --> 00:01:21.366
connects to the SMTP server,

00:01:21.366 --> 00:01:24.866
and issues a VRFY command for
a given username.

00:01:26.176 --> 00:01:28.966
Let’s make this script executable
and try it out.

00:01:39.061 --> 00:01:42.200
Great, our script is working perfectly.
